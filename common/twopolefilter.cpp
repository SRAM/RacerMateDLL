
#ifdef WIN32
	#include <windows.h>
#endif

#include "twopolefilter.h"

/**************************************************************************************

**************************************************************************************/

twoPoleFilter::twoPoleFilter(int _n)  {
	n = (double)_n;
	k = .27;
	reset();
}

/**************************************************************************************

**************************************************************************************/

twoPoleFilter::~twoPoleFilter(void) {
}

/**************************************************************************************

**************************************************************************************/

double twoPoleFilter::calc(double in)  {
	if (n <= 0.0)  {
		return in;
	}

	a += (in - a + (in-fval)*k) / 16.0f;
	fval += (a-fval)/16.0f;

	return fval;
}

/**************************************************************************************

**************************************************************************************/

void twoPoleFilter::setState(double _fval, double _a)  {

	fval = _fval;
	a = _a;

	return;
}

/**************************************************************************************

**************************************************************************************/

void twoPoleFilter::getState(double *_fval, double *_a)  {

	*_fval = fval;
	*_a = a;

	return;
}

/**************************************************************************************

**************************************************************************************/

void twoPoleFilter::reset(void)  {

	fval = 0.0;
	a = 0.0;
	return;
}

